---
title: "Kice's mini-cookie"
subtitle: "Learn Data Science with R"  
author: "shitao"
date: '`r Sys.Date()`'
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.height=3.5, fig.retina=3,
  out.width = "100%",
  cache = TRUE,
  echo = TRUE,
  message = FALSE, 
  warning = FALSE,
  hiline = TRUE
)
```

```{r xaringan-themer, warning=FALSE, include=FALSE}
library(xaringanthemer)
style_mono_accent(
  base_color = "#1c5253",
  header_font_google = google_font("Josefin Sans"),
  text_font_google   = google_font("Montserrat", "300", "300i"),
  code_font_google   = google_font("Fira Mono"),
  colors = c(
    red = "#EA4335"
  ),
  link_color = "#e75874"
)
library(tidyverse)
```

<!-- 中文字体需要改进 -->

# Tab of Contents

1. [Data Science](#data-science)

1. [Tidy Data](#tidy-data)

1. [In/Export Data](#data)

---
class: inverse, center, middle
name: data-science

# Data Science

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

---

# My understanding

数据科学可以理解为**与数据打交道的科学**。科学并不意味着“高大上”，它代表的是一种标准，一种普遍认可的流程。比如说自然科学可以理解为认识自然的一种普适方式……

因此，数据科学也可以理解为**一种处理数据的普适方式**，大家都按照某一种方法处理数据，就会形成数据科学。处理数据不只有一种方式<sup>1</sup>，而主流的会被留下来继续发展<sup>2</sup>，目前看就是Tidy Data。

.footnote[
1：Tidy data就是一种方式，“道”而不是“技”上的区分，不管是用R或者用Python完成Tidy Data的清洗，都属于同一种方式。

2：可以部分认为“存在即合理”。
]

--

<br><br>

<b>.red[总结起来：数据科学是一种数据思维，具体而言，是Tidy Data的思维。]</b>

---
class: inverse, center, middle
name: tidy-data

# Tidy Data

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

---
name: definition

# Definition

Tidy data is a standard way of **mapping** the meaning of a dataset to its structure. A dataset is messy or tidy depending on how rows, columns and tables are matched up with observations, variables and types. In tidy data:

- Every column is a variable.

- Every row is an observation.

- Every cell is a single value.

--

从整体上看Tidy Data是数据框(data.frame、tibble)，每一个变量组成一列，每一行是一条记录。

判断以下数据框是否为Tidy Data:

```{r data, echo=FALSE}
data <- tibble(
  姓名 = c("张三", "李四", "王五"),
  语文 = c(57, 67, 78),
  数学 = c(67, 89, 96),
  英语 = c(56, 78, 87)
)
data
```

---

答案揭晓：.red[不是！]

做对了吗？

--

真正的Tidy形式是这样的：

```{r data_tidy, echo=FALSE}
data_tidy <- data |> 
  pivot_longer(2:4, names_to = "学科",
               values_to = "成绩")
data_tidy
```

--

相比于第一个数据框，整洁形式：

1. 把语文、数学、英语归为**学科**变量；
1. 把所有成绩都归到**成绩**变量；
1. 以上两点通常会导致Tidy Data显得较长（行数多）。

---

# 时刻需要整洁数据吗？

--

并非如此。整洁数据的优势在于数据可视化（后面会讲到），分组操作等等<sup>1</sup>，它更多是用于数据 分析的中间阶段，而不是日常使用。在数据录入、回归分析等方面，宽数据具有更大的优势。比如：

- 计算语文成绩的最高分：`max(data$语文)`为`r max(data$语文)`。

- 回归分析时会写`因变量 = 语文 + 数学 + 英语`这样的回归方程。

.footnote[
1: 辅以整洁数据的思维方能大用。
]

---
layout: true

# Tidy Data & ggplot

---

ggplot画图的前提就是整洁数据。

通过`?ggplot`查看ggplot的帮助文档，可以看到它的用法：

```{r ggplot-help, eval=FALSE}
ggplot(data = NULL, mapping = aes(), ...)
```

--

除了data，ggplot最重要的就是映射**mapping**，是否觉得这个词很熟悉。若想不起来，参见[这里](#definition)。

--

```{r mapping, eval=FALSE}
ggplot(data_tidy, aes(x = 学科, y = 成绩)) + #<<
  geom_point()
```

在`aes()`中，我们把学科映射到了x轴，把成绩映射到y轴，实现从数据到图形元素的转变。（图参见下一页）

---

```{r mapping2, echo=FALSE, fig.height=2}
ggplot(data_tidy, aes(x = 学科, y = 成绩)) + #<<
  geom_point()
```

可以想象，在非整洁的形式下，x轴只能映射语文或数学或英语一科的成绩，那是一个连续型的数据，会让x轴成为一个数轴。

--

如果想让图反映学生的信息，只需要将姓名映射到图形中，可以映射到颜色（color），形状（shape），大小（size，需要数值型变量，这里行不通）等元素中，这里我们映射到颜色上。

---

```{r mapping3}
ggplot(data_tidy, aes(x = 学科, y = 成绩, color = 姓名)) + #<<
  geom_point()
```

--

可以看出，我捏造的数据有效区分了学霸和学渣。

---

同一个变量可以映射给多个元素，比如颜色和形状都接受姓名的映射：

```{r mapping4}
ggplot(data_tidy, aes(x = 学科, y = 成绩,
                      color = 姓名, shape = 姓名)) + #<<
  geom_point()
```


---
layout: false
class: inverse, center, middle
name: data

# In/Export Data

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

下期内容
